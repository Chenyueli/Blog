---
layout: post
title: "JS实现图片上传和预览"
date: 2017-03-19
excerpt: "FileReader(),window.URL.createObjectURL"
tag:
- javascript

comments: false
---

http://www.helloweba.com/view-blog-224.html



			var path = getImgURL(fileElement);
			if(path != false) {
				fileElement.parentElement.previousElementSibling.innerHTML = "<img width='80px' height='80px' src='" + path + "'/>";
				fileElement.parentElement.style.opacity = 0;

				var image = "";
				var reader = new FileReader();
				reader.onload = function(e) {
					image = e.target.result;
				}
				reader.readAsDataURL(fileElement.files[0]);
			}


	//fileElement是input type="file"元素
	//检查图片，格式正确返回 图像URL 否则返回false
	function getImgURL(fileElement) {
		var filextension = fileElement.value.substring(fileElement.value.lastIndexOf("."), fileElement.value.length);
		filextension = filextension.toLowerCase();
		if(filextension != '.jpg') {
			alert("对不起，系统仅支持.jpg格式图片!");
			return false;
		} else {
			var path;
			path = window.URL.createObjectURL(fileElement.files[0]);
			console.log(path);
			return path;
			
			
			
			
	//	var image;
	//js读取图片并转成base64编码
	function readImgBase64(fileElement) {
		var image = "";
		var reader = new FileReader();
		reader.onload = function(e) {
			image = e.target.result;
			alert(image);
		}
		reader.readAsDataURL(fileElement.files[0]);
		//		alert(image);
		return image;
	};